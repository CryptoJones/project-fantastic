# Data Sources

Data source scripts are used for gathering data about the network and storing it in the server's database.

## Data source output

This should be generated by a script placed in the `config/data_sources` directory. It should be returned by a Promise / async function.

    {
      hosts: ['local', 'remote'], // can we run this command on a local and/or remote host
      result_type: 'ip_addresses' | 'mac_addresses' | 'hostname' | 'os | 'hosts' | 'connections', // see below for description of each result type
      run: hostname => {} // function which takes the hostname of the computer we're targeting (or null if it's the local host), and returns the results in the format expected by the result type 
    }

## Result types

### ip_addresses

An array of IP Addresses in string format belonging to a single host

    ['127.0.0.1', '192.168.1.1', ...]

### mac_addresses

An array of MAC Addresses belonging to a single host.

Each entry contains the address and vendor in string format. If we know the actual name of the device we can use that in the vendor property.

    [
      {mac: '4C:CC:6A:61:D1:07', vendor: 'Realtek PCIe GBE Family Controller'},
      {mac: '62:45:B4:F1:DB:1C', vendor: 'Xbox Wireless Adapter for Windows'},
      ...
    ]

### hostname

The hostname of a host in string format

### os

The operating system of a host in string format

### hosts

An object containing information about the local host and an array of remote hosts.

    {
      local: {
        ips, // see ip_addresses
        macs, // see mac_addresses
        hostname,
        os
      },
      remote: [
        {
          // same format as local
        },
        ...
      ]
    }

### connections

An array of data about connections from a host.

Possible connection states are:
  - listen
  - syn_sent
  - syn_received
  - established
  - fin_wait_1
  - fin_wait_2
  - close_wait
  - closing
  - last_ack
  - time_wait
  - bound

</a>

    [
      {
        local_address, // local IP Address in string format
        local_port, // number
        remote_address, // remote IP Address in string format
        remote_port, // number
        process, // PID of process owning this connection in number format
        state // see possible states above
      },
      ...
    ]
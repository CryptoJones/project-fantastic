{
  "name": "Check Windows Defender Firewall Status",
  "description": "This command should show the three default profiles (there might be more though).",
  "hosts": ["local", "remote"],
  "role": "privileged",
  "functions": {
    "run": {
      "command": "get-netfirewallprofile | select name, enabled",
      "method": "invoke",
      "json": true,
      "result": {
        "name": [
          {"type": "header", "content": "name"},
          {
            "type": "button", 
            "content": {"bool": "Enabled", "true": "Enabled", "false": "Disabled"},
            "click": {
              "function": "enable_profile",
              "data": {
                "profile": "name",
                "state": {"bool": "Enabled", "true": "Enabled", "false": "Disabled"}
              }
            },
            "class": {
              "disabled": {"bool": "Enabled", "true": "Enabled", "false": "Disabled"}
            }
          },
          {
            "type": "button",
            "content": {"static": "Get Profile Rules"},
            "click": {
              "function": "get_rules",
              "data": {
                "profile": "name"
              }
            }
          }
        ]
      }
    },
    "enable_profile": {
      "command": "Set-NetFirewallProfile -Profile $profile -Enabled $state"
    }
  }
}